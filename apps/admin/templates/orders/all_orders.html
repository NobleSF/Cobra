{% extends "admin_base.html" %}
{% load url from future %}

{% block javascript %}
<script>
  $().ready(function(){
  });

  $('.has-info').click(function(){
    alert($(this).attr('data-info'));
  });

</script>
{% endblock javascript %}

{% block css %}
<style>

  .has-info{cursor: pointer;}

</style>
{% endblock css %}

{% block content %}

<h3>ORDERS</h3>

<table class='table table-hover table-condensed'>
  <thead>
    <td>ORDER</td>
    <td>DATE&nbsp;TIME</td>
    <td>ITEM</td>
    <td>STATUS</td>
    <td colspan='2'>PAYMENT</td>
  </thead>

  {% for order in orders %}
    <tr class='information-row'>
      <td>
        <a href="{% url 'admin:order' order.id %}">
          <i class='symbol-go blue'></i>
        </a>
      </td>

      <td>{{ order.created_at|date:"m/d  H:i" }}</td>

      <td>
        <a href="{{ order.products.all.0.get_absolute_url }}"
            target='_blank'>
          {{ order.products.all.0.id }}
        </a>
      </td>

      <td style='white-space: nowrap;'>
        <i title='{{ order.seller_confirmed_at|date:"m/d  H:i" }}'
           class='symbol-SMS
                  {% if order.is_seller_confirmed  %}green has-info
                  {% else %}red{% endif %}'
           data-info='{{ order.seller_confirmed_at|date:"m/d  H:i" }}'
           ></i>

        <i title='{{ order.shipped_at|date:"m/d  H:i" }}'
           class='symbol-SMS-shipping
                  {% if order.is_shipped %}green has-info
                  {% else %}red{% endif %}'
           data-info='{{ order.shipped_at|date:"m/d  H:i" }}'
           ></i>



        <i title='{{ order.tracking_number }}'
           class='symbol-shipping
                  {% if order.tracking_number %}green has-info
                  {% else %}red{% endif %}'
           data-info='{{ order.tracking_number }}'
           ></i>

        <i title='{{ order.seller_paid_at|date:"m/d  H:i" }}'
           class='symbol-money
              {% if order.is_seller_paid %}green has-info
              {% else %}red{% endif %}'
           data-info='{{ order.seller_paid_at|date:"m/d  H:i" }}'
           ></i>
      </td>


      <td {% if not order.is_seller_paid %}style='font-weight: 800;'{% endif %}>
        {{ order.products.all.0.seller.name }}{# todo: make seller a model property #}
        <br>
        {{ order.products.all.0.seller.account.bank_name }}
      </td>
      <td {% if not order.is_seller_paid %}style='font-weight: 800;'{% endif %}>
        {{ order.seller_paid_amount|floatformat:0 }}
        <small>{{ order.products.all.0.seller.country.currency.code }}</small>
        <br>
        {{ order.products.all.0.seller.account.bank_account }}
      </td>

    </tr>
  {% endfor %}

</table>

<p class='text-center' style='text-decoration: underline; font-size: 20pt;'>
  see Tom for more
</p>

{% endblock content %}
