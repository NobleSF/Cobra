function validateForm(){var a=!0;return $("#checkout-form  input.required").each(function(){$(this).removeClass("error"),$(this).val()==""?(a=!1,$(this).closest(".control-group").addClass("error"),$(this).closest(".control-group").find(".help-inline").fadeOut().fadeIn()):$(this).attr("id")=="id_email"&&(IsEmail($(this).val())?($(this).closest(".control-group").removeClass("error"),$(this).closest(".control-group").find(".help-inline").fadeOut()):(a=!1,$(this).closest(".control-group").addClass("error"),$(this).closest(".control-group").find(".help-inline").fadeOut().fadeIn()))}),a}function IsEmail(a){var b=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)}function manualCheckout(){var a=$("#manual_checkout_url").val();$.get(a).fail(function(){$("#admin-checkout-button").hide("300"),$(".admin-checkout-error").show("300")}).done(function(){$("input").attr("disabled","disabled"),$("#admin-checkout-button").hide("300"),$(".admin-checkout-success").show("300")})}function validateManualCheckout(){return!0}$(function(){if(768<$(window).width()&&$(window).width()<979||navigator.userAgent.match(/(iPhone|iPod|iPad)/i))$("#main-content").removeClass("span8").addClass("span12"),$("#information").removeClass("span4").addClass("span12");$(".autosave").each(function(){$(this).autosave({url:$("#cart-ajax-url").attr("value"),before:function(){$(this).addClass("updating")},success:function(){$(this).removeClass("updating").addClass("saved")},error:function(){$(this).removeClass("updating").addClass("error")}})})}),$("#checkout-button").on("click",function(){$(".part1").slideUp(400),$(".part2").delay(400).slideDown(400)}),$("#pay-now-button").on("click",function(){validateForm()&&($("#customer-info").slideUp(400),$("#payment").delay(400).slideDown(400))}),$("#cart-return-button").on("click",function(){$(".part3").slideUp(400),$(".part2").slideUp(400),$(".part1").delay(400).slideDown(400)}),$("#checkout-form").find("#id_email").on("blur",function(){$(this).mailcheck({suggested:function(a,b){$("#suggested-email").html(b.full),$("#email-suggestion").show()},empty:function(a){$("#suggested-email").html(""),$("#email-suggestion").hide()}})}),$("#suggested-email").click(function(){$("#checkout-form").find("#id_email").val($("#suggested-email").html()),$("#suggested-email").html(""),$("#email-suggestion").hide(),$("#checkout-form").find("#id_email").trigger("change")}),$("input.required").on("change",function(){$(this).val()==""?$(this).closest(".control-group").addClass("error"):$(this).closest(".control-group").hasClass("error")&&validateForm()}),$("#admin-checkout-button").click(function(){validateManualCheckout()&&manualCheckout()}),jQuery.fn.autosave=function(a){function b(a){var b=/^data\-(\w+)$/,d={};return d.value=a.value,d.name=a.name,c.each(a.attributes,function(a,c){b.test(c.nodeName)&&(d[b.exec(c.nodeName)[1]]=c.value)}),d}var c=jQuery;c.each(this,function(){var d=c(this),f={data:{},event:"change",success:function(){},error:function(){},before:function(){}};a=c.extend(f,a);var g=b(this),h=g.event||a.event;d.on(h,function(){var d=c(this);g.value=d.val(),g=c.extend(g,b(this));var f=g.url?g.url:a.url;a.before&&a.before.call(this,d),c.ajax({url:f,data:g,success:function(b){a.success(b,d)},error:function(b){a.error(b,d)}})})})};var Kicksend={mailcheck:{threshold:3,defaultDomains:"yahoo.com google.com hotmail.com gmail.com me.com aol.com mac.com live.com comcast.net googlemail.com msn.com hotmail.co.uk yahoo.co.uk facebook.com verizon.net sbcglobal.net att.net gmx.com mail.com".split(" "),defaultTopLevelDomains:"co.uk com net org info edu gov mil".split(" "),run:function(a){a.domains=a.domains||Kicksend.mailcheck.defaultDomains,a.topLevelDomains=a.topLevelDomains||Kicksend.mailcheck.defaultTopLevelDomains,a.distanceFunction=a.distanceFunction||Kicksend.sift3Distance;var b=Kicksend.mailcheck.suggest(encodeURI(a.email),a.domains,a.topLevelDomains,a.distanceFunction);b?a.suggested&&a.suggested(b):a.empty&&a.empty()},suggest:function(a,b,c,d){a=a.toLowerCase(),a=this.splitEmail(a);if(b=this.findClosestDomain(a.domain,b,d)){if(b!=a.domain)return{address:a.address,domain:b,full:a.address+"@"+b}}else if(c=this.findClosestDomain(a.topLevelDomain,c),a.domain&&c&&c!=a.topLevelDomain)return b=a.domain,b=b.substring(0,b.lastIndexOf(a.topLevelDomain))+c,{address:a.address,domain:b,full:a.address+"@"+b};return!1},findClosestDomain:function(a,b,c){var d,e=99,f=null;if(!a||!b)return!1;c||(c=this.sift3Distance);for(var g=0;g<b.length;g++){if(a===b[g])return a;d=c(a,b[g]),d<e&&(e=d,f=b[g])}return e<=this.threshold&&null!==f?f:!1},sift3Distance:function(a,b){if(null==a||0===a.length)return null==b||0===b.length?0:b.length;if(null==b||0===b.length)return a.length;for(var c=0,d=0,e=0,f=0;c+d<a.length&&c+e<b.length;){if(a.charAt(c+d)==b.charAt(c+e))f++;else for(var g=e=d=0;5>g;g++){if(c+g<a.length&&a.charAt(c+g)==b.charAt(c)){d=g;break}if(c+g<b.length&&a.charAt(c)==b.charAt(c+g)){e=g;break}}c++}return(a.length+b.length)/2-f},splitEmail:function(a){a=a.split("@");if(2>a.length)return!1;for(var b=0;b<a.length;b++)if(""===a[b])return!1;var c=a.pop(),d=c.split("."),e="";if(0==d.length)return!1;if(1==d.length)e=d[0];else{for(b=1;b<d.length;b++)e+=d[b]+".";2<=d.length&&(e=e.substring(0,e.length-1))}return{topLevelDomain:e,domain:c,address:a.join("@")}}}};window.jQuery&&function(a){a.fn.mailcheck=function(a){var b=this;if(a.suggested){var c=a.suggested;a.suggested=function(a){c(b,a)}}if(a.empty){var d=a.empty;a.empty=function(){d.call(null,b)}}a.email=this.val(),Kicksend.mailcheck.run(a)}}(jQuery)