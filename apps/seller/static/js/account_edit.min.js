function applySellerAutosave(){$("#seller-account").find(".autosave").autosave({url:$("#save-seller-url").val(),before:saveSellerBefore,success:saveSellerSuccess,error:saveSellerError})}function saveSellerBefore(a){a.closest("#seller-account").removeClass("error").removeClass("saved").addClass("updating")}function saveSellerSuccess(a,b){b.closest(".asset").removeClass("updating").addClass("saved")}function saveSellerError(a,b){b.closest(".asset").removeClass("updating").addClass("error")}function arrangeAssetForms(){$("#asset-forms .asset").each(function(){applyDataAttrs($(this)),applyEvents($(this));var a=$(this).find("#id_ilk").val();a!=""&&$(this).appendTo("#"+a+"_container")})}function addAssetForms(){$(".asset-container").each(function(){var a=$(this),b=0;a.children(".asset").each(function(){this_asset=$(this),this_asset.hasClass("empty")&&b++});if(b==0){var c=$("#asset-forms .asset").first().clone(!1),d=a.attr("id").replace("_container",""),e=0;$(".asset").each(function(){var a=$(this).find("input#id_rank").val();parseInt(a)>e&&(e=parseInt(a))});var f=e+1;c.find("input#id_rank").attr("value",f),c.find("input#id_ilk").attr("value",d),c.attr("id","asset-"+d+f),c.appendTo(a),applyDataAttrs(c),applyEvents(c)}})}function applyDataAttrs(a,b,c){b=b||a.find("#id_ilk").val(),c=c||a.find("#id_rank").val(),b!=="product"?a.find(".asset-category").hide():a.find(".asset-category").show(),b!=="artisan"?a.find(".asset-phone").hide():a.find(".asset-phone").show(),a.find(".image").attr("id",b+c+"-image-div"),a.find(".image-input").attr("id",b+c+"-image-input"),a.find(".autosave").attr("data-ilk",b),a.find(".autosave").attr("data-rank",c)}function applyEvents(a,b){image_input=a.find(".image-input"),image_div=a.find(".image"),uploader=new fileUploadAction,uploader.apply(image_input,image_div),b=b||!0,b&&(applyAssetAutosave(a),applyAssetDeleteAction(a))}$().ready(function(){$("#asset-tabs").children("li").first().addClass("active"),$("#artisan_tab").trigger("click"),applyDataAttrs($("#seller-account"),"seller","seller"),applyEvents($("#seller-account"),to_assets=!1),applySellerAutosave(),arrangeAssetForms(),addAssetForms()}),$(".language-btn").click(function(){language=$(this).attr("data-lang"),$(".lang").hide(),$(".lang-"+language).show(),$(".language-btn").removeClass("btn-success"),$(this).addClass("btn-success")}),$(".asset-tab").click(function(){$(".asset-tab").removeClass("active"),$(this).addClass("active"),$(".asset-container").hide(),asset_ilk=$(this).attr("id").replace("_tab",""),$("#"+asset_ilk+"_container").show()}),jQuery.fn.autosave=function(a){function b(a){var b=/^data\-(\w+)$/,d={};return d.value=a.value,d.name=a.name,c.each(a.attributes,function(a,c){b.test(c.nodeName)&&(d[b.exec(c.nodeName)[1]]=c.value)}),d}var c=jQuery;c.each(this,function(){var d=c(this),f={data:{},event:"change",success:function(){},error:function(){},before:function(){}};a=c.extend(f,a);var g=b(this),h=g.event||a.event;d.on(h,function(){var d=c(this);g.value=d.val(),g=c.extend(g,b(this));var f=g.url?g.url:a.url;a.before&&a.before.call(this,d),c.ajax({url:f,data:g,success:function(b){a.success(b,d)},error:function(b){a.error(b,d)}})})})}