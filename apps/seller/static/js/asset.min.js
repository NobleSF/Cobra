function autosaveAssets(a){$(a).autosave({url:$("#asset-url").val(),type:"json",data:{seller_id:$("#seller-id").val()},before:function(){$(this).closest(".asset").removeClass("empty").removeClass("error").removeClass("saved"),$(this).closest(".asset").addClass("updating"),$(this).attr("data-name")=="delete"&&$(this).closest(".asset").addClass("soon-dead"),addAssetForms()},done:function(a){$(this).closest(".asset").removeClass("updating").addClass("saved"),a.value=="delete"&&$(this).closest(".asset").fadeOut(500,function(){$(this).remove()})},always:function(){$(this).removeClass("updating").addClass("error")}})}function fileUploadAction(){this.apply=function(a){var b=!1,c=a,d={},e=new Spinner,f=c.closest(".image-upload-div").find(".spinner-div"),g=c.closest(".image-upload-div").find(".image-forms");c.closest(".asset-media").find(".progress").hide(),c.closest(".image-upload-div").find(".image-forms"),c.fileupload({dataType:"json",url:$("#upload-url").val(),submit:function(a,b){var c=g.find(".data-form");b.formData=getFormData(c),d=b.formData,d.ilk=$(g).find(".ilk").val(),d.rank=$(g).find(".rank").val(),d.ilkrank=d.ilk+d.rank},send:function(a,c){c.dataType.indexOf("iframe")>=0&&(b=!0),c.files[0].name.length>0&&(b?setTimeout(function(){loadImage(d)},1e4):($("#progress-bar-"+d.ilkrank).css("width","0%"),$("#progress-"+d.ilkrank).show()),e.spin(document.getElementById($(f).attr("id"))),$(f).show(),g.hide())},progress:function(a,b){var c=parseInt(b.loaded/b.total*95,10);$("#progress-bar-"+d.ilkrank).css("width",c+"%")},done:function(a,c){b||loadImage(d)},always:function(a,b){$("#progress-"+d.ilkrank).hide(),e.stop(),g.show()}})}}function getFormData(a){var b={};return $.ajax({async:!1,cache:!1,type:a.attr("method"),url:a.attr("action"),data:a.serialize(),dataType:"json",success:function(a){b=a}}),b}function loadImage(a){$.ajax({async:!1,url:$("#upload-check-url").val(),cache:!1,data:a,dataType:"json"}).done(function(b,c,d){switch(d.status){case 200:$("#image-"+a.ilkrank).find("img").attr("src",b.thumb_url),$("#progress-"+a.ilkrank).hide(),$("#spinner-"+a.ilkrank).hide(),$("#image-forms-"+a.ilkrank).show(),$("#asset-"+a.ilk+a.rank).removeClass("empty").removeClass("error").addClass("saved"),addAssetForms();break;case 204:setTimeout(function(){loadImage(a)},2e3);case 404:}}).fail(function(){$("#asset-"+a.ilk+a.rank).addClass("error")})}$().ready(function(){arrangeAssetForms(),autosaveAssets(".autosave"),addAssetForms(),bindButtons()}),function(a,b,c,d){function e(b,c){this.element=b,this.options=a.extend({},g,c),this._defaults=g,this._name=f,this.init()}var f="autosave",g={url:"",method:"POST",event:"change",data:{},type:"html",debug:!1,before:function(){},done:function(){},fail:function(){},always:function(){}};e.prototype.init=function(){function b(b){var c=/^data\-(\w+)$/,d={};return d.value=b.val()||"",d.name=b.attr("name")||"",a(b[0].attributes).each(function(){c.test(this.nodeName)&&(attribute_name=c.exec(this.nodeName)[1],d[attribute_name]=this.nodeValue)}),d}var c=a(this.element),d=b(c),e=this.options,d=b(c);e.event=d.event||e.event,c.on(e.event,function(d){e.before&&e.before.call(c);var f=b(c);options=a.extend({},e,f);var g=a.extend({},options.data,f);options.debug=="false"&&(options.debug=!1),delete g.url,delete g.method,delete g.type,delete g.debug,g.event=options.event,options.debug?console.log(g):a.ajax({url:options.url,type:options.method,cache:!1,data:g,dataType:options.type}).done(function(a,b,d){c.data("autosave-data",a),c.data("autosave-textStatus",b),c.data("autosave-jqXHR",d),c.trigger("autosave-done")}).fail(function(a,b,d){c.data("autosave-jqXHR",a),c.data("autosave-textStatus",b),c.data("autosave-errorThrown",d),c.trigger("autosave-fail")}).always(function(){c.trigger("autosave-always")})}),e.done&&c.on("autosave-done",function(){var a=c.data("autosave-data"),b=c.data("autosave-textStatus"),d=c.data("autosave-jqXHR");options.done.call(c,a,b,d)}),e.fail&&c.on("autosave-fail",function(){var a=c.data("autosave-jqXHR"),b=c.data("autosave-textStatus"),d=c.data("autosave-errorThrown");options.fail.call(c,a,b,d)}),e.always&&c.on("autosave-always",function(){options.always.call(c)})},a.fn.autosave=function(a){return this.each(function(){new e(this,a)})}}(jQuery,window,document),function(a,b){typeof exports=="object"?module.exports=b():typeof define=="function"&&define.amd?define(b):a.Spinner=b()}(this,function(){function d(a,b){var c=document.createElement(a||"div"),d;for(d in b)c[d]=b[d];return c}function e(a){for(var b=1,c=arguments.length;b<c;b++)a.appendChild(arguments[b]);return a}function g(a,d,e,g){var h=["opacity",d,~~(a*100),e,g].join("-"),i=.01+e/g*100,j=Math.max(1-(1-a)/d*(100-i),a),k=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=k&&"-"+k+"-"||"";return b[h]||(f.insertRule("@"+l+"keyframes "+h+"{"+"0%{opacity:"+j+"}"+i+"%{opacity:"+a+"}"+(i+.01)+"%{opacity:1}"+(i+d)%100+"%{opacity:"+a+"}"+"100%{opacity:"+j+"}"+"}",f.cssRules.length),b[h]=1),h}function h(b,c){var d=b.style,e,f;if(d[c]!==undefined)return c;c=c.charAt(0).toUpperCase()+c.slice(1);for(f=0;f<a.length;f++){e=a[f]+c;if(d[e]!==undefined)return e}}function i(a,b){for(var c in b)a.style[h(a,c)||c]=b[c];return a}function j(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]===undefined&&(a[d]=c[d])}return a}function k(a){var b={x:a.offsetLeft,y:a.offsetTop};while(a=a.offsetParent)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function m(a){if(typeof this=="undefined")return new m(a);this.opts=j(a||{},m.defaults,l)}function n(){function a(a,b){return d("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',b)}f.addRule(".spin-vml","behavior:url(#default#VML)"),m.prototype.lines=function(b,c){function g(){return i(a("group",{coordsize:f+" "+f,coordorigin:-d+" "+ -d}),{width:f,height:f})}function l(b,f,h){e(j,e(i(g(),{rotation:360/c.lines*b+"deg",left:~~f}),e(i(a("roundrect",{arcsize:c.corners}),{width:d,height:c.width,left:c.radius,top:-c.width>>1,filter:h}),a("fill",{color:c.color,opacity:c.opacity}),a("stroke",{opacity:0}))))}var d=c.length+c.width,f=2*d,h=-(c.width+c.length)*2+"px",j=i(g(),{position:"absolute",top:h,left:h}),k;if(c.shadow)for(k=1;k<=c.lines;k++)l(k,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(k=1;k<=c.lines;k++)l(k);return e(b,j)},m.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}"use strict";var a=["webkit","Moz","ms","O"],b={},c,f=function(){var a=d("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],a),a.sheet||a.styleSheet}(),l={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};m.defaults={},j(m.prototype,{spin:function(a){this.stop();var b=this,e=b.opts,f=b.el=i(d(0,{className:e.className}),{position:e.position,width:0,zIndex:e.zIndex}),g=e.radius+e.length+e.width,h,j;a&&(a.insertBefore(f,a.firstChild||null),j=k(a),h=k(f),i(f,{left:(e.left=="auto"?j.x-h.x+(a.offsetWidth>>1):parseInt(e.left,10)+g)+"px",top:(e.top=="auto"?j.y-h.y+(a.offsetHeight>>1):parseInt(e.top,10)+g)+"px"})),f.setAttribute("role","progressbar"),b.lines(f,b.opts);if(!c){var l=0,m=(e.lines-1)*(1-e.direction)/2,n,o=e.fps,p=o/e.speed,q=(1-e.opacity)/(p*e.trail/100),r=p/e.lines;(function s(){l++;for(var a=0;a<e.lines;a++)n=Math.max(1-(l+(e.lines-a)*r)%p*q,e.opacity),b.opacity(f,a*e.direction+m,n,e);b.timeout=b.el&&setTimeout(s,~~(1e3/o))})()}return b},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=undefined),this},lines:function(a,b){function k(a,c){return i(d(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:a,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*f+b.rotate)+"deg) translate("+b.radius+"px"+",0)",borderRadius:(b.corners*b.width>>1)+"px"})}var f=0,h=(b.lines-1)*(1-b.direction)/2,j;for(;f<b.lines;f++)j=i(d(),{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":"",opacity:b.opacity,animation:c&&g(b.opacity,b.trail,h+f*b.direction,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&e(j,i(k("#000","0 0 4px #000"),{top:"2px"})),e(a,e(j,k(b.color,"0 0 1px rgba(0,0,0,.1)")));return a},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=i(d("group"),{behavior:"url(#default#VML)"});return!h(o,"transform")&&o.adj?n():c=h(o,"animation"),m})