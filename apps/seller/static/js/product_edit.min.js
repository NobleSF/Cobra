function markAssignedAssetsAsSelected(){asset_ids=$("#id_assets").val().split(" "),$.each(asset_ids,function(a,b){if(b!==""){var c=$('[store-input_id="assets"][store-object_id="'+b+'"]');$(c).addClass("active").addClass("selected")}}),color_ids=$("#id_colors").val().split(" "),$.each(color_ids,function(a,b){if(b!==""){var c=$('[store-input_id="colors"][store-object_id="'+b+'"]');$(c).addClass("active").addClass("selected")}}),shipping_option_ids=$("#id_shipping_options").val().split(" "),$.each(shipping_option_ids,function(a,b){if(b!==""){var c=$('[store-input_id="shipping_options"][store-object_id="'+b+'"]');$(c).addClass("active").addClass("selected")}})}function toggleStoreAssetId(a){asset_id=a.attr("store-object_id"),input_element=$("#id_"+a.attr("store-input_id")),input_element_value=input_element.attr("value"),input_element_value===undefined&&(input_element_value=""),a.hasClass("selected")?input_element_value.match(asset_id)||(input_element_value=input_element_value+" "+asset_id,input_element.attr("value",input_element_value)):(input_element_value=input_element_value.replace(asset_id,""),input_element.attr("value",input_element_value)),input_element.trigger("change")}function toggleActiveState(a){asset_input=a.find("input"),a.hasClass("selected")?asset_input.attr("data-status","active"):asset_input.attr("data-status",""),asset_input.trigger("change")}function applyAutosaveDataToTextAttributes(){$(".giveMeData").each(function(){$(this).attr("data-product_id",$("#id_product_id").val()),attribute=$(this).attr("id").replace("id_",""),$(this).attr("data-attribute",attribute)})}function applyAutosaveEvents(){$(".autosave").each(function(){$(this).autosave({url:$("#product-ajax-url").attr("value"),before:function(){$(this).addClass("updating")},success:function(a){$(this).removeClass("updating").addClass("saved"),updateSummary(a)},error:function(){$(this).removeClass("updating").addClass("error")}})})}function updateSummary(a){first_photo_url=$("#photo1").closest(".photo-upload-div").find("img").attr("src"),!first_photo_url||($("#summary-section").find(".summary-image").find("img").attr("src",first_photo_url),$("#floating-photo").find(".image").find("img").attr("src",first_photo_url),$("#confirmation").find(".image").find("img").attr("src",first_photo_url)),seller_price=a.summary_price,seller_price!==""&&$("#summary-price").html(seller_price),shipping_cost=a.summary_shipping_cost,parseInt(shipping_cost)!==0?$("#summary-shipping").html(shipping_cost):$("#summary-shipping").html(""),total=parseInt(seller_price)+parseInt(shipping_cost),$("#summary-total").html(total)}function validateForm(){return $(".attention").removeClass("attention"),no_errors=!0,$("#product-chooser-section").find(".selected").length===0&&($("#product-chooser-section").addClass("attention"),no_errors=!1),$("#artisan-chooser-section").find(".selected").length===0&&($("#artisan-chooser-section").addClass("attention"),no_errors=!1),$("#photos").find(".photo").first().find("img").length===0&&($("#photos-section").addClass("attention"),no_errors=!1),$("#id_price").val()>0||($("#price-section").addClass("attention"),no_errors=!1),$("#id_weight").val()>0||($("#measurements-section").addClass("attention"),no_errors=!1),$("#id_shipping_options").val().trim().length===0&&($("#shipping-option-chooser-section").addClass("attention"),no_errors=!1),no_errors||($("#photos").find(".photo-form").click(function(){$(this).closest("photos-section").removeClass("attention")}),$("#product-chooser-section").click(function(){$(this).removeClass("attention")}),$("#artisan-chooser-section").click(function(){$(this).removeClass("attention")}),$("#id_price").click(function(){$(this).closest("#price-section").removeClass("attention")}),$("#id_weight").click(function(){$(this).closest("#measurements-section").removeClass("attention")}),$("#shipping-option-chooser-section").click(function(){$(this).removeClass("attention")})),no_errors}$().ready(function(){$("i").click(function(){$(this).closest("table").find("input").focus()}),$("#id_price, #id_weight, #id_width, #id_height, #id_length").on("focus",function(){$(this).closest("td").next("td").next("td").find("button").css("opacity","1")}),$("#id_price, #id_weight, #id_width, #id_height, #id_length").on("blur",function(){$(this).closest("td").next("td").next("td").find("button").css("opacity","0.01")}),$("#id_weight").on("blur",function(){envelope=$("#shipping-option-chooser-section .asset[store-object_id=2]"),$(this).val()>450?($(envelope).hasClass("selected")&&$(envelope).click(),envelope.hide()):envelope.show()}),markAssignedAssetsAsSelected(),$(".total-cost").bind("click",function(){$(".extra").toggle()}),$(".asset").each(function(){$(this).bind("click",function(){$(this).toggleClass("active"),$(this).toggleClass("selected"),toggleStoreAssetId($(this)),toggleActiveState($(this))})}),applyAutosaveDataToTextAttributes(),applyAutosaveEvents(),$("#submit").bind("click",function(){validateForm()?$.ajax({url:$("#product-ajax-url").attr("value"),data:{attribute:"active",status:"yes",product_id:$("#product-id").val()}}).success(function(){$("#product-edit-form").hide(),$("#floating-photo").remove(),$("#confirmation").show(),$.scrollTo("#header")}):$.scrollTo($(".attention").first(),1100)})}),jQuery.fn.autosave=function(a){function b(a){var b=/^data\-(\w+)$/,d={};return d.value=a.value,d.name=a.name,c.each(a.attributes,function(a,c){b.test(c.nodeName)&&(d[b.exec(c.nodeName)[1]]=c.value)}),d}var c=jQuery;c.each(this,function(){var d=c(this),f={data:{},event:"change",success:function(){},error:function(){},before:function(){}};a=c.extend(f,a);var g=b(this),h=g.event||a.event;d.on(h,function(){var d=c(this);g.value=d.val(),g=c.extend(g,b(this));var f=g.url?g.url:a.url;a.before&&a.before.call(this,d),c.ajax({url:f,data:g,success:function(b){a.success(b,d)},error:function(b){a.error(b,d)}})})})},function(a){function c(a){return typeof a=="object"?a:{top:a,left:a}}var b=a.scrollTo=function(b,c,d){a(window).scrollTo(b,c,d)};b.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1,limit:!0},b.window=function(b){return a(window)._scrollable()},a.fn._scrollable=function(){return this.map(function(){var b=this,c=!b.nodeName||a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!c)return b;var d=(b.contentWindow||b).document||b.ownerDocument||b;return/webkit/i.test(navigator.userAgent)||d.compatMode=="BackCompat"?d.body:d.documentElement})},a.fn.scrollTo=function(d,e,f){return typeof e=="object"&&(f=e,e=0),typeof f=="function"&&(f={onAfter:f}),d=="max"&&(d=9e9),f=a.extend({},b.defaults,f),e=e||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(e/=2),f.offset=c(f.offset),f.over=c(f.over),this._scrollable().each(function(){function o(a){j.animate(m,e,f.easing,a&&function(){a.call(this,d,f)})}if(d==null)return;var i=this,j=a(i),k=d,l,m={},n=j.is("html,body");switch(typeof k){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(k)){k=c(k);break}k=a(k,this);if(!k.length)return;case"object":if(k.is||k.style)l=(k=a(k)).offset()}a.each(f.axis.split(""),function(a,c){var d=c=="x"?"Left":"Top",e=d.toLowerCase(),p="scroll"+d,q=i[p],r=b.max(i,c);if(l)m[p]=l[e]+(n?0:q-j.offset()[e]),f.margin&&(m[p]-=parseInt(k.css("margin"+d))||0,m[p]-=parseInt(k.css("border"+d+"Width"))||0),m[p]+=f.offset[e]||0,f.over[e]&&(m[p]+=k[c=="x"?"width":"height"]()*f.over[e]);else{var s=k[e];m[p]=s.slice&&s.slice(-1)=="%"?parseFloat(s)/100*r:s}f.limit&&/^\d+$/.test(m[p])&&(m[p]=m[p]<=0?0:Math.min(m[p],r)),!a&&f.queue&&(q!=m[p]&&o(f.onAfterFirst),delete m[p])}),o(f.onAfter)}).end()},b.max=function(b,c){var d=c=="x"?"Width":"Height",e="scroll"+d;if(!a(b).is("html,body"))return b[e]-a(b)[d.toLowerCase()]();var f="client"+d,g=b.ownerDocument.documentElement,h=b.ownerDocument.body;return Math.max(g[e],h[e])-Math.min(g[f],h[f])}}(jQuery)